<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Document</title>
  </head>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
        "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans",
        "Helvetica Neue", sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-align: center;
      color: #494949;
    }

    .main {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .badges > * {
      margin-right: 8px;
    }
    .container {
      padding: 16px;
    }

    .input {
      width: 45px;
      height: 45px;
      padding: 0;
      font-size: 24px;
      text-align: center;
      margin-right: 12px;
      text-transform: uppercase;
      color: #494949;
      font-family: SF Pro Text, SF Pro Icons, Helvetica Neue, Helvetica, Arial,
        sans-serif;
      border: 1px solid #d6d6d6;
      border-radius: 4px;
      background: #fff;
      background-clip: padding-box;
    }

    .input:focus {
      appearance: none;
      outline: 0;
      box-shadow: 0 0 0 3px rgb(131 192 253 / 50%);
    }

    button {
      appearance: none;
      background: #0071e3;
      border-radius: 980px;
      text-align: center;
      border: none;
      color: #fff;
      margin: 8px;
      padding: 4px 11px;
    }

    .submit-btn:hover {
      cursor: pointer;
    }

    p {
      font-size: 17px;
      line-height: 1.47059;
    }

    .props {
      border: 1px solid #d6d6d6;
      padding: 8px 16px;
    }

    .options {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .allowed-characters {
      text-align: left;
    }
  </style>
  <body></body>
  <script src="https://unpkg.com/fetch-jsonp@1.3.0/build/fetch-jsonp.js"></script>
  <script>
    const checkUrl = "https://unpkg.com/fetch-jsonp@1.3.0/build/fetch-jsonp.js"; // /favicon.ico
    /*! offline-js 0.7.14 */
    (function () {
      var a, b, c, d, e, f, g;
      (d = function (a, b) {
        var c, d, e, f;
        e = [];
        for (d in b.prototype)
          try {
            (f = b.prototype[d]),
              null == a[d] && "function" != typeof f
                ? e.push((a[d] = f))
                : e.push(void 0);
          } catch (g) {
            c = g;
          }
        return e;
      }),
        (a = {}),
        null == a.options && (a.options = {}),
        (c = {
          checks: {
            xhr: {
              url: function () {
                return `${checkUrl}?_=` + new Date().getTime();
              },
              timeout: 5e3,
              type: "HEAD",
            },
            image: {
              url: function () {
                return `${checkUrl}?_=` + new Date().getTime();
              },
            },
            active: "xhr",
          },
          checkOnLoad: !1,
          interceptRequests: !0,
          reconnect: !0,
          deDupBody: !1,
        }),
        (e = function (a, b) {
          var c, d, e, f, g, h;
          for (
            c = a, h = b.split("."), d = e = 0, f = h.length;
            f > e && ((g = h[d]), (c = c[g]), "object" == typeof c);
            d = ++e
          );
          return d === h.length - 1 ? c : void 0;
        }),
        (a.getOption = function (b) {
          var d, f;
          return (
            (f = null != (d = e(a.options, b)) ? d : e(c, b)),
            "function" == typeof f ? f() : f
          );
        }),
        "function" == typeof window.addEventListener &&
          window.addEventListener(
            "online",
            function () {
              return setTimeout(a.confirmUp, 100);
            },
            !1
          ),
        "function" == typeof window.addEventListener &&
          window.addEventListener(
            "offline",
            function () {
              return a.confirmDown();
            },
            !1
          ),
        (a.state = "up"),
        (a.markUp = function () {
          return (
            a.trigger("confirmed-up"),
            "up" !== a.state ? ((a.state = "up"), a.trigger("up")) : void 0
          );
        }),
        (a.markDown = function () {
          return (
            a.trigger("confirmed-down"),
            "down" !== a.state
              ? ((a.state = "down"), a.trigger("down"))
              : void 0
          );
        }),
        (f = {}),
        (a.on = function (b, c, d) {
          var e, g, h, i, j;
          if (((g = b.split(" ")), g.length > 1)) {
            for (j = [], h = 0, i = g.length; i > h; h++)
              (e = g[h]), j.push(a.on(e, c, d));
            return j;
          }
          return null == f[b] && (f[b] = []), f[b].push([d, c]);
        }),
        (a.off = function (a, b) {
          var c, d, e, g, h;
          if (null != f[a]) {
            if (b) {
              for (e = 0, h = []; e < f[a].length; )
                (g = f[a][e]),
                  (d = g[0]),
                  (c = g[1]),
                  c === b ? h.push(f[a].splice(e, 1)) : h.push(e++);
              return h;
            }
            return (f[a] = []);
          }
        }),
        (a.trigger = function (a) {
          var b, c, d, e, g, h, i;
          if (null != f[a]) {
            for (g = f[a], i = [], d = 0, e = g.length; e > d; d++)
              (h = g[d]), (b = h[0]), (c = h[1]), i.push(c.call(b));
            return i;
          }
        }),
        (b = function (a, b, c) {
          var d, e, f, g, h;
          return (
            (h = function () {
              return a.status && a.status < 12e3 ? b() : c();
            }),
            null === a.onprogress
              ? ((d = a.onerror),
                (a.onerror = function () {
                  return (
                    c(),
                    "function" == typeof d ? d.apply(null, arguments) : void 0
                  );
                }),
                (g = a.ontimeout),
                (a.ontimeout = function () {
                  return (
                    c(),
                    "function" == typeof g ? g.apply(null, arguments) : void 0
                  );
                }),
                (e = a.onload),
                (a.onload = function () {
                  return (
                    h(),
                    "function" == typeof e ? e.apply(null, arguments) : void 0
                  );
                }))
              : ((f = a.onreadystatechange),
                (a.onreadystatechange = function () {
                  return (
                    4 === a.readyState ? h() : 0 === a.readyState && c(),
                    "function" == typeof f ? f.apply(null, arguments) : void 0
                  );
                }))
          );
        }),
        (a.checks = {}),
        (a.checks.xhr = function () {
          var c, d;
          (d = new XMLHttpRequest()),
            (d.offline = !1),
            d.open(
              a.getOption("checks.xhr.type"),
              a.getOption("checks.xhr.url"),
              !0
            ),
            null != d.timeout &&
              (d.timeout = a.getOption("checks.xhr.timeout")),
            b(d, a.markUp, a.markDown);
          try {
            d.send();
          } catch (e) {
            (c = e), a.markDown();
          }
          return d;
        }),
        (a.checks.image = function () {
          var b;
          return (
            (b = document.createElement("img")),
            (b.onerror = a.markDown),
            (b.onload = a.markUp),
            void (b.src = a.getOption("checks.image.url"))
          );
        }),
        (a.checks.down = a.markDown),
        (a.checks.up = a.markUp),
        (a.check = function () {
          return (
            a.trigger("checking"), a.checks[a.getOption("checks.active")]()
          );
        }),
        (a.confirmUp = a.confirmDown = a.check),
        (a.onXHR = function (a) {
          var b, c, e;
          return (
            (e = function (b, c) {
              var d;
              return (
                (d = b.open),
                (b.open = function (e, f, g, h, i) {
                  return (
                    a({
                      type: e,
                      url: f,
                      async: g,
                      flags: c,
                      user: h,
                      password: i,
                      xhr: b,
                    }),
                    d.apply(b, arguments)
                  );
                })
              );
            }),
            (c = window.XMLHttpRequest),
            (window.XMLHttpRequest = function (a) {
              var b, d, f;
              return (
                (f = new c(a)),
                e(f, a),
                (d = f.setRequestHeader),
                (f.headers = {}),
                (f.setRequestHeader = function (a, b) {
                  return (f.headers[a] = b), d.call(f, a, b);
                }),
                (b = f.overrideMimeType),
                (f.overrideMimeType = function (a) {
                  return (f.mimeType = a), b.call(f, a);
                }),
                f
              );
            }),
            d(window.XMLHttpRequest, c),
            null != window.XDomainRequest
              ? ((b = window.XDomainRequest),
                (window.XDomainRequest = function () {
                  var a;
                  return (a = new b()), e(a), a;
                }),
                d(window.XDomainRequest, b))
              : void 0
          );
        }),
        (g = function () {
          return (
            a.getOption("interceptRequests") &&
              a.onXHR(function (c) {
                var d;
                return (
                  (d = c.xhr),
                  d.offline !== !1 ? b(d, a.markUp, a.confirmDown) : void 0
                );
              }),
            a.getOption("checkOnLoad") ? a.check() : void 0
          );
        }),
        setTimeout(g, 0),
        (window.Offline = a);
    }).call(this),
      function () {
        var a, b, c, d, e, f, g, h, i;
        if (!window.Offline)
          throw new Error("Offline Reconnect brought in without offline.js");
        (d = Offline.reconnect = {}),
          (f = null),
          (e = function () {
            var a;
            return (
              null != d.state &&
                "inactive" !== d.state &&
                Offline.trigger("reconnect:stopped"),
              (d.state = "inactive"),
              (d.remaining = d.delay =
                null != (a = Offline.getOption("reconnect.initialDelay"))
                  ? a
                  : 3)
            );
          }),
          (b = function () {
            var a, b;
            return (
              (a =
                null != (b = Offline.getOption("reconnect.delay"))
                  ? b
                  : Math.min(Math.ceil(1.5 * d.delay), 3600)),
              (d.remaining = d.delay = a)
            );
          }),
          (g = function () {
            return "connecting" !== d.state
              ? ((d.remaining -= 1),
                Offline.trigger("reconnect:tick"),
                0 === d.remaining ? h() : void 0)
              : void 0;
          }),
          (h = function () {
            return "waiting" === d.state
              ? (Offline.trigger("reconnect:connecting"),
                (d.state = "connecting"),
                Offline.check())
              : void 0;
          }),
          (a = function () {
            return Offline.getOption("reconnect")
              ? (e(),
                (d.state = "waiting"),
                Offline.trigger("reconnect:started"),
                (f = setInterval(g, 1e3)))
              : void 0;
          }),
          (i = function () {
            return null != f && clearInterval(f), e();
          }),
          (c = function () {
            return Offline.getOption("reconnect") && "connecting" === d.state
              ? (Offline.trigger("reconnect:failure"),
                (d.state = "waiting"),
                b())
              : void 0;
          }),
          (d.tryNow = h),
          e(),
          Offline.on("down", a),
          Offline.on("confirmed-down", c),
          Offline.on("up", i);
      }.call(this),
      function () {
        var a, b, c, d, e, f;
        if (!window.Offline)
          throw new Error("Requests module brought in without offline.js");
        (c = []),
          (f = !1),
          (d = function (a) {
            return Offline.getOption("requests") !== !1
              ? (Offline.trigger("requests:capture"),
                "down" !== Offline.state && (f = !0),
                c.push(a))
              : void 0;
          }),
          (e = function (a) {
            var b, c, d, e, f, g, h, i, j;
            if (
              ((j = a.xhr),
              (g = a.url),
              (f = a.type),
              (h = a.user),
              (d = a.password),
              (b = a.body),
              Offline.getOption("requests") !== !1)
            ) {
              j.abort(), j.open(f, g, !0, h, d), (e = j.headers);
              for (c in e) (i = e[c]), j.setRequestHeader(c, i);
              return j.mimeType && j.overrideMimeType(j.mimeType), j.send(b);
            }
          }),
          (a = function () {
            return (c = []);
          }),
          (b = function () {
            var b, d, f, g, h, i, j;
            if (Offline.getOption("requests") !== !1) {
              for (
                Offline.trigger("requests:flush"), i = {}, d = 0, g = c.length;
                g > d;
                d++
              )
                (h = c[d]),
                  (j = h.url.replace(/(\?|&)_=[0-9]+/, function (a, b) {
                    return "?" === b ? b : "";
                  })),
                  Offline.getOption("deDupBody")
                    ? ((b = h.body),
                      (b =
                        "[object Object]" === b.toString()
                          ? JSON.stringify(b)
                          : b.toString()),
                      (i[h.type.toUpperCase() + " - " + j + " - " + b] = h))
                    : (i[h.type.toUpperCase() + " - " + j] = h);
              for (f in i) (h = i[f]), e(h);
              return a();
            }
          }),
          setTimeout(function () {
            return Offline.getOption("requests") !== !1
              ? (Offline.on("confirmed-up", function () {
                  return f ? ((f = !1), a()) : void 0;
                }),
                Offline.on("up", b),
                Offline.on("down", function () {
                  return (f = !1);
                }),
                Offline.onXHR(function (a) {
                  var b, c, e, f, g;
                  return (
                    (g = a.xhr),
                    (e = a.async),
                    g.offline !== !1 &&
                    ((f = function () {
                      return d(a);
                    }),
                    (c = g.send),
                    (g.send = function (b) {
                      return (a.body = b), c.apply(g, arguments);
                    }),
                    e)
                      ? null === g.onprogress
                        ? (g.addEventListener("error", f, !1),
                          g.addEventListener("timeout", f, !1))
                        : ((b = g.onreadystatechange),
                          (g.onreadystatechange = function () {
                            return (
                              0 === g.readyState
                                ? f()
                                : 4 === g.readyState &&
                                  (0 === g.status || g.status >= 12e3) &&
                                  f(),
                              "function" == typeof b
                                ? b.apply(null, arguments)
                                : void 0
                            );
                          }))
                      : void 0
                  );
                }),
                (Offline.requests = { flush: b, clear: a }))
              : void 0;
          }, 0);
      }.call(this),
      function () {
        var a, b, c, d, e;
        if (!Offline)
          throw new Error("Offline simulate brought in without offline.js");
        for (d = ["up", "down"], b = 0, c = d.length; c > b; b++)
          (e = d[b]),
            (document.querySelector("script[data-simulate='" + e + "']") ||
              ("undefined" != typeof localStorage && null !== localStorage
                ? localStorage.OFFLINE_SIMULATE
                : void 0) === e) &&
              (null == Offline.options && (Offline.options = {}),
              null == (a = Offline.options).checks && (a.checks = {}),
              (Offline.options.checks.active = e));
      }.call(this),
      function () {
        var a, b, c, d, e, f, g, h, i, j, k, l, m;
        if (!window.Offline)
          throw new Error("Offline UI brought in without offline.js");
        (b =
          '<div class="offline-ui"><div class="offline-ui-content"></div></div>'),
          (a = '<a href class="offline-ui-retry"></a>'),
          (f = function (a) {
            var b;
            return (
              (b = document.createElement("div")),
              (b.innerHTML = a),
              b.children[0]
            );
          }),
          (g = e = null),
          (d = function (a) {
            return k(a), (g.className += " " + a);
          }),
          (k = function (a) {
            return (g.className = g.className.replace(
              new RegExp("(^| )" + a.split(" ").join("|") + "( |$)", "gi"),
              " "
            ));
          }),
          (i = {}),
          (h = function (a, b) {
            return (
              d(a),
              null != i[a] && clearTimeout(i[a]),
              (i[a] = setTimeout(function () {
                return k(a), delete i[a];
              }, 1e3 * b))
            );
          }),
          (m = function (a) {
            var b, c, d, e;
            d = { day: 86400, hour: 3600, minute: 60, second: 1 };
            for (c in d)
              if (((b = d[c]), a >= b)) return (e = Math.floor(a / b)), [e, c];
            return ["now", ""];
          }),
          (l = function () {
            var c, h;
            return (
              (g = f(b)),
              document.body.appendChild(g),
              null != Offline.reconnect &&
                Offline.getOption("reconnect") &&
                (g.appendChild(f(a)),
                (c = g.querySelector(".offline-ui-retry")),
                (h = function (a) {
                  return a.preventDefault(), Offline.reconnect.tryNow();
                }),
                null != c.addEventListener
                  ? c.addEventListener("click", h, !1)
                  : c.attachEvent("click", h)),
              d("offline-ui-" + Offline.state),
              (e = g.querySelector(".offline-ui-content"))
            );
          }),
          (j = function () {
            return (
              l(),
              Offline.on("up", function () {
                return (
                  k("offline-ui-down"),
                  d("offline-ui-up"),
                  h("offline-ui-up-2s", 2),
                  h("offline-ui-up-5s", 5)
                );
              }),
              Offline.on("down", function () {
                return (
                  k("offline-ui-up"),
                  d("offline-ui-down"),
                  h("offline-ui-down-2s", 2),
                  h("offline-ui-down-5s", 5)
                );
              }),
              Offline.on("reconnect:connecting", function () {
                return d("offline-ui-connecting"), k("offline-ui-waiting");
              }),
              Offline.on("reconnect:tick", function () {
                var a, b, c;
                return (
                  d("offline-ui-waiting"),
                  k("offline-ui-connecting"),
                  (a = m(Offline.reconnect.remaining)),
                  (b = a[0]),
                  (c = a[1]),
                  e.setAttribute("data-retry-in-value", b),
                  e.setAttribute("data-retry-in-unit", c)
                );
              }),
              Offline.on("reconnect:stopped", function () {
                return (
                  k("offline-ui-connecting offline-ui-waiting"),
                  e.setAttribute("data-retry-in-value", null),
                  e.setAttribute("data-retry-in-unit", null)
                );
              }),
              Offline.on("reconnect:failure", function () {
                return (
                  h("offline-ui-reconnect-failed-2s", 2),
                  h("offline-ui-reconnect-failed-5s", 5)
                );
              }),
              Offline.on("reconnect:success", function () {
                return (
                  h("offline-ui-reconnect-succeeded-2s", 2),
                  h("offline-ui-reconnect-succeeded-5s", 5)
                );
              })
            );
          }),
          "complete" === document.readyState
            ? j()
            : null != document.addEventListener
            ? document.addEventListener("DOMContentLoaded", j, !1)
            : ((c = document.onreadystatechange),
              (document.onreadystatechange = function () {
                return (
                  "complete" === document.readyState && j(),
                  "function" == typeof c ? c.apply(null, arguments) : void 0
                );
              }));
      }.call(this);
  </script>
  <script type="module">
    import {
      createElement,
      useId,
      useRef,
      render,
      useLayoutEffect,
      useEffect,
      useImperativeHandle,
      forwardRef,
    } from "https://esm.sh/@preact/compat@17.1.2";
    console.log(Offline.check());

    Offline.on("down", () => {
      console.log(Offline.state);
    });
    // You can check React behaviour with replacing the import above with this:
    // import { createElement, useId } from 'https://esm.sh/stable/react@18.2.0/es2022/react.mjs'
    // import { render } from 'https://esm.sh/stable/react-dom@18.2.0/es2022/react-dom.mjs'

    window["jsonpCallback"] = (props) => {
      console.log(props);
    };
    const e = createElement;

    const propsMap = {
      alpha: {
        type: "text",
        inputMode: "text",
        pattern: "[a-zA-Z]{1}",
      },

      alphanumeric: {
        type: "text",
        inputMode: "text",
        pattern: "[a-zA-Z0-9]{1}",
      },

      numeric: {
        type: "tel",
        inputMode: "numeric",
        pattern: "[0-9]{1}",
        min: "0",
        max: "9",
      },
    };
    const AuthInput = forwardRef(
      (
        {
          allowedCharacters = "alphanumeric",
          ariaLabel,
          autoFocus = true,
          containerClassName = "container",
          disabled = false,
          inputClassName = "input",
          isPassword = false,
          length = 6,
          placeholder,
          onChange,
        },
        ref
      ) => {
        const inputs = [];
        const inputsRef = useRef([]);
        const inputProps = propsMap[allowedCharacters];

        for (let i = 0; i < length; i++) {
          const ip = useRef(null);
          inputsRef.current[i] = ip;
        }

        useImperativeHandle(ref, () => ({
          focus: () => {
            if (inputsRef.current) {
              inputsRef.current[0].focus();
            }
          },
          clear: () => {
            if (inputsRef.current) {
              for (let i = 0; i < inputsRef.current.length; i++) {
                inputsRef.current[i].value = "";
              }
              inputsRef.current[0].focus();
            }
            sendResult();
          },
        }));

        useEffect(() => {
          if (autoFocus) {
            inputsRef.current[0].focus();
          }
        }, []);

        const sendResult = () => {
          const res = inputsRef.current.map((input) => input.value).join("");
          onChange && onChange(res);
        };

        const handleOnChange = (e) => {
          const {
            target: { value, nextElementSibling },
          } = e;
          if (value.length > 1) {
            e.target.value = value.charAt(0);
            if (nextElementSibling !== null) {
              nextElementSibling.focus();
            }
          } else {
            if (value.match(inputProps.pattern)) {
              if (nextElementSibling !== null) {
                nextElementSibling.focus();
              }
            } else {
              e.target.value = "";
            }
          }
          sendResult();
        };

        const handleOnKeyDown = (e) => {
          const { key } = e;
          const target = e.target;
          if (key === "Backspace") {
            if (target.value === "") {
              if (target.previousElementSibling !== null) {
                const t = target.previousElementSibling;
                t.value = "";
                t.focus();
                e.preventDefault();
              }
            } else {
              target.value = "";
            }
            sendResult();
          }
        };

        const handleOnFocus = (e) => {
          e.target.select();
        };

        const handleOnPaste = (e) => {
          const pastedValue = e.clipboardData.getData("Text");

          let currentInput = 0;

          for (let i = 0; i < pastedValue.length; i++) {
            const pastedCharacter = pastedValue.charAt(i);
            const currentValue = inputsRef.current[currentInput].value;
            if (pastedCharacter.match(inputProps.pattern)) {
              if (!currentValue) {
                inputsRef.current[currentInput].value = pastedCharacter;
                if (
                  inputsRef.current[currentInput].nextElementSibling !== null
                ) {
                  inputsRef.current[currentInput].nextElementSibling.focus();
                  currentInput++;
                }
              }
            }
          }
          sendResult();

          e.preventDefault();
        };

        const handleButtonClick = (e) => {
          fetchJsonp("http://www.google.com")
            .then(function (response) {
              return response.json();
            })
            .then(function (json) {
              console.log("parsed json", json);
            })
            .catch(function (ex) {
              console.log("parsing failed", ex);
            });
        };

        for (let i = 0; i < length; i++) {
          inputs.push(
            e("input", {
              type: isPassword ? "password" : inputProps.type,
              key: i,
              onChange: handleOnChange,
              onKeyDown: handleOnKeyDown,
              onFocus: handleOnFocus,
              onPaste: handleOnPaste,
              ref: (el) => {
                inputsRef.current[i] = el;
              },
              maxLength: 1,
              className: inputClassName,
              autoComplete: i === 0 ? "one-time-code" : "off",
              disabled,
              placeholder: "-",
            })
          );
        }

        return e(
          "div",
          { className: containerClassName },
          inputs,
          e(
            "button",
            { className: "submit-btn", onClick: handleButtonClick },
            "Download"
          )
        );
      }
    );

    render(e(AuthInput, {}), document.body);
  </script>
</html>
