好的，我们来设计这个配置面板的交互和表单内容。

核心目标是**“简单易懂”**，这意味着我们需要遵循几个重要的UX（用户体验）设计原则：

1.  **引导式工作流 (Guided Workflow):** 面板的组织顺序应该引导用户按照“先选数据 -> 再选图表类型 -> 然后映射数据 -> 最后调整样式”的逻辑流程进行操作。
2.  **渐进式披露 (Progressive Disclosure):** 不要一次性把所有选项都展示给用户。只展示当前步骤最需要关心的配置，当用户做出选择后，再展示下一步相关的配置。
3.  **实时预览 (Real-time Preview):** 右侧面板的任何改动，都应该（在防抖后）立刻在左侧画布的图表上体现出来，形成一个即时的反馈闭环。

基于这些原则，我建议使用**可折叠的面板 (Accordion)** 或者**卡片**来组织表单内容。

---

### **配置面板 UI 结构与字段设计**

#### **面板顶部：全局配置 (Global Configuration)**

这部分放置最重要、最顶层的配置。

1.  **图表标题 (Chart Title)**
    * **控件:** 文本输入框 (`<input type="text">`)
    * **作用:** 用户输入图表的标题。
    * **映射到配置:** `presentation.title.text`

2.  **图表类型 (Chart Type)**
    * **控件:** **带图标的下拉选择器或单选按钮组**。这是整个面板中最重要的控件。
    * **作用:** 用户选择图表的核心展现形式。
    * **选项:**
        * `📈 折线图 (line)`
        * `📊 柱状图 (bar)`
        * `⭕ 饼图 (pie)`
        * `🎯 雷达图 (radar)`
        * `⏱️ 仪表盘 (gauge)`
        * ...
    * **映射到配置:** `encoding.chartType`
    * **核心交互:** **这个控件的值将动态决定下方“图表映射”面板的内容。**

---

#### **折叠面板一：数据源 (Data Source)**

默认展开，引导用户第一步先配置数据。

1.  **数据集 (Dataset)**
    * **控件:** 下拉列表 (`<select>`)
    * **作用:** 选择一个预先定义好的数据集。
    * **映射到配置:** `dataSource.datasetId`
    * **交互:** 选择后，下方的“动态参数”区域会根据该数据集的 `parameters` 元数据动态生成。

2.  **动态参数 (Dynamic Parameters)**
    * **控件:** 这是一个**动态渲染区域**，根据上一步选择的数据集来决定内容。
    * **作用:** 让用户输入调用 API 所需的参数。
    * **映射到配置:** `dataSource.params`
    * **交互:**
        * 如果 `selectedDataset.parameters` 为空，则此区域不显示。
        * 如果有参数，则 `v-for` 遍历参数数组，根据每个参数的 `type` 属性渲染不同的输入控件（如文本框、日期选择器、下拉框等）。

3.  **数据刷新 (Data Refresh)**
    * **控件:** 开关 (`<switch>`) + 下拉列表 (`<select>`)
    * **作用:** 配置图表的自动刷新。
    * **字段:**
        * `自动刷新`: 开/关
        * `刷新频率`: (当开启时显示) 30秒 / 1分钟 / 5分钟...
    * **映射到配置:** 这部分属于图表的运行时行为，可以不存储在 `UniversalChartConfig` 中，而是作为图表实例的元数据。

---

#### **折叠面板二：图表映射 (Chart Mapping / Encoding)**

这是最能体现“简单易懂”设计的地方。**此面板的内容会根据顶部的“图表类型”选择器动态切换**。

##### **当 `图表类型` 为 `折线图` 或 `柱状图` 时 (笛卡尔坐标系):**

* **X轴 / 分类轴 (X-Axis / Category)**
    * **控件:** 下拉列表。列表选项动态来自于数据预览后的字段名。
    * **作用:** 选择哪个数据字段作为 X 轴。
    * **映射到配置:** `encoding.x.field`
* **Y轴 / 指标轴 (Y-Axis / Value)**
    * **控件:** 下拉列表 (可支持多选，用于生成多系列图表)。
    * **作用:** 选择哪个数据字段作为 Y 轴的度量值。
    * **映射到配置:** `encoding.y.field`
* **分组 / 系列 (Group / Series)**
    * **控件:** 下拉列表 (可选)。
    * **作用:** 选择一个分类字段来将数据拆分成多个系列（例如，在折线图中生成多条线）。
    * **映射到配置:** `encoding.color.field`

##### **当 `图表类型` 为 `饼图` 或 `环形图` 时:**

* **分类名称 (Category Name)**
    * **控件:** 下拉列表。
    * **作用:** 选择哪个字段用来定义饼图的每个扇区的名称。
    * **映射到配置:** `encoding.color.field`
* **数值 (Value)**
    * **控件:** 下拉列表。
    * **作用:** 选择哪个字段用来决定每个扇区的大小。
    * **映射到配置:** `encoding.angle.field`

##### **当 `图表类型` 为 `仪表盘` 时:**

* **指标值 (Metric Value)**
    * **控件:** 下拉列表。
    * **作用:** 选择哪个字段的数值作为仪表盘指针指向的值。
    * **映射到配置:** `encoding.value.field`

---

#### **折叠面板三：样式与展示 (Style & Presentation)**

这个面板用于进行视觉上的微调。

1.  **图例 (Legend)**
    * **显示图例:** 开关 (`<switch>`) -> `presentation.legend.visible`
    * **图例位置:** 单选按钮组 (`<radio-group>`) (上/下/左/右) -> `presentation.legend.position`

2.  **坐标轴 (Axes)** (仅当图表类型有坐标轴时显示)
    * **显示X轴标签:** 开关
    * **显示Y轴网格线:** 开关
    * ... 其他坐标轴相关的样式配置

3.  **图表选项 (Chart Options)**
    * **堆叠显示 (Stack):** 开关 (仅当图表类型为柱状图/面积图时显示) -> `presentation.stack`
    * **平滑曲线 (Smooth Line):** 开关 (仅当图表类型为折线图时显示) -> 映射到 ECharts 的 `series.smooth` 属性。
    * **配色方案 (Color Palette):** 颜色选择器或预设方案列表 -> `presentation.colorScheme`

---

### **用户操作流程示例**

1.  用户将一个图表组件拖入画布，右侧面板出现。
2.  在**面板顶部**，用户在**“图表类型”**中选择了 `⭕ 饼图`。
3.  此时，**“图表映射”**面板自动切换为饼图的配置界面，显示“分类名称”和“数值”两个下拉框。
4.  用户展开**“数据源”**面板，在**“数据集”**下拉框中选择了“各服务CPU耗时统计”。
5.  系统根据该数据集的定义，自动填充了**“动态参数”**区域，例如一个“时间范围”选择器。
6.  用户配置好时间范围，点击**“预览数据”**按钮（这一步可以被系统自动触发），获取到了包含 `service` 和 `total_cpu` 字段的数据。
7.  用户回到**“图表映射”**面板。
8.  在**“分类名称”**下拉框中，他看到了 `service` 和 `total_cpu` 两个选项，他选择了 `service`。
9.  在**“数值”**下拉框中，他选择了 `total_cpu`。
10. 左侧的画布上，一个展示各服务CPU耗时占比的饼图立刻被渲染了出来。
11. 最后，用户在**顶部**的**“图表标题”**输入框中输入“服务CPU占比分析”，图表标题实时更新。

通过这样一套**上下文感知、动态切换、引导清晰**的UI设计，即使是非技术用户也能轻松地将数据源配置成各种复杂的图表，完美地将你设计的 `UniversalChartConfig` 转化为一个用户友好的产品功能。
